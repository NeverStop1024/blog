---
title: lint-staged
date: 2022-08-31 22:58:04
permalink: /pages/39c0fd/
categories:
  - å·¥å…·
tags:
  - 
author: 
  name: NeverStop1024
  link: https://github.com/NeverStop1024
---
[lint-staged](https://github.com/okonet/lint-staged) æ˜¯ä¸€ä¸ªåªæ£€æµ‹gitæš‚å­˜åŒºçš„lintå·¥å…·ã€‚å¯ä»¥é¿å…æˆ‘ä»¬æ¯æ¬¡æ£€æŸ¥éƒ½æŠŠæ•´ä¸ªé¡¹ç›®çš„ä»£ç éƒ½æ£€æŸ¥ä¸€éï¼Œä»è€Œæé«˜æ•ˆç‡ã€‚å…·ä½“æ£€æŸ¥è§„åˆ™ï¼Œè¿˜è¦é…ç½®ã€‚
#### å®‰è£…
`yarn add -D lint-staged`
#### æ·»åŠ lint-stagedé…ç½®
* æ–¹æ³•ä¸€ï¼šåœ¨`package.json`ä¸­æ·»åŠ  ï¼ˆæ¨èğŸ‘ï¼‰
* æ–¹æ³•äºŒï¼šåˆ›å»º`.lintstagedrc` æ–‡ä»¶ 
* æ–¹æ³•ä¸‰ï¼šåˆ›å»º`lint-staged.config.js` æ–‡ä»¶å¹¶è¿›è¡Œé…ç½®  
```json
// ä»¥package.jsonä¸­æ·»åŠ ä¸ºä¾‹
"husky": {
  "hooks": {
    "pre-commit": "lint-staged",
  }
},
"lint-staged": {
  "*.vue": [
    "eslint --fix",
    "stylelint --fix",
    "git add"
  ],
  "*.{js,jsx,ts,tsx}": [
    "eslint --fix",
    "git add"
  ],
  "*.{htm,html,css,sss,less,scss,sass}": [
    "stylelint --fix",
    "git add"
  ]
}
```
**æ³¨æ„**  
* lint-staged v10ä¹‹å‰æ¯ä¸ªä»»åŠ¡æœ€åéƒ½è¦åŠ `git add`ï¼Œå› ä¸ºæ¯ä¸ªlintä»»åŠ¡éƒ½æœ‰å¯èƒ½ä¿®å¤ä»£ç ã€ç¾åŒ–æ ¼å¼ï¼Œè¿™äº›ä¿®æ”¹çš„æ–‡ä»¶è¦å†æ¬¡`git add .`æ‰èƒ½è¢«`git commit`,  
* æ‰€ä»¥å¿…é¡»åœ¨æ¯ä¸ªä»»åŠ¡ååŠ ä¸Š`git add`ï¼Œlint-staged è¯†åˆ«åˆ°git addåï¼Œè‡ªåŠ¨å°†è¯¥lintä»»åŠ¡ä¿®æ”¹çš„æ–‡ä»¶æ·»åŠ åˆ°æš‚å­˜åŒºã€‚å°±ä¸ä¼šå½±å“`git commit`æäº¤äº†ã€‚  
* ä½†åœ¨v10ä¹‹åï¼Œå®˜æ–¹å¯¹æ­¤åšäº†ä¼˜åŒ–ï¼Œä¸ç”¨å»å†™`git add`ï¼Œlint-stagedè‡ªåŠ¨å°†ä¿®æ”¹çš„æ–‡ä»¶åŠ å…¥æš‚å­˜åŒºã€‚  
![img_pAcJoL](https://cdn.jsdelivr.net/gh/NeverStop1024/images-store@main/blog/img_pAcJoL.png)

#### ä½¿ç”¨
lint-stagedä¸€èˆ¬é…åˆhuskyçš„`pre-commit`ï¼ˆgit commitå‰çš„hooksï¼‰ä½¿ç”¨ã€‚  
æ¯æ¬¡`git commit`æ—¶ï¼Œpre-commitä¼šå…ˆæ‹¦æˆªï¼Œæ‰§è¡Œå®Œ`/.husky/pre-commit`ä¸­ä»£ç ï¼Œå¦‚æœæ²¡æœ‰æŠ¥é”™ï¼Œæ‰ä¼šæ­£å¸¸æäº¤ã€‚
```javascript
// /.husky/pre-commit
#!/bin/sh
. "$(dirname "$0")/_/husky.sh"

yarn lint-staged
```
